
<div class="container mt-5">
  <h1 class="text-center">里親募集詳細</h1>

  <div class="card mt-4 bg-light">
    <div class="card-body">

      <!-- ユーザー情報 -->
      <div class="d-flex align-items-center mb-3">
        <%= image_tag @rescued_cat.user.get_profile_image(100,100), class: "mr-3 rounded-circle" %>
        <div>
          <%= link_to my_page_user_path(@rescued_cat.user) do %>
            <p class="font-weight-bold mb-0"><%= @rescued_cat.user.nickname %></p>
          <% end %>
          <%= render 'public/relationships/follow_btn', user: current_user %>
        </div>
      </div>

      <!-- 画像 -->
      <div class="container mt-5">
        <div class="row justify-content-center">
          <div class="col-md-8">
               <% if @rescued_cat.images.attached? %>
                <% @rescued_cat.images.each do |image| %>
                  <%= image_tag image, class: "img-fluid ", size: "700x700" %>
                <% end %>
              <% end %>
          </div>
        </div>
      </div>

      
  
      <!-- 詳細情報 -->
      <p><%= render 'public/rescued_cats/label', rescued_cat: @rescued_cat %></p> 
      <p class="font-weight-bold"><%= @rescued_cat.title %></p>
      <p><%= @rescued_cat.body %></p>
      <p>名前：<%= @rescued_cat.name || "不明" %></p>
      <p>性別：<%= @rescued_cat.sex %></p>
      <p>年齢：<%= @rescued_cat.age.present? ? "#{@rescued_cat.age} 才" : "不明" %></p>
      <p>ワクチン：<%= @rescued_cat.vaccine %></p>
      <p>去勢/避妊手術：<%= @rescued_cat.is_castration ? "手術済" : "未手術" %></p>
      <p>譲渡先：<%= @rescued_cat.is_completion ? "譲渡先決定！" : "募集中" %></p>

      <!-- ブックマークとコメント -->
      <p><%= render 'public/rescued_cats/bookmark', rescued_cat: @rescued_cat %></p>
      <p><i class="far fa-comment"></i> <%= @rescued_cat.rescued_cat_comments.count %></p>
      <% @rescued_cat.rescued_cat_comments.each do |rescued_cat_comment| %>
     <div class="comment">
        <%= link_to my_page_user_path(rescued_cat_comment.user) do %>
          <%= rescued_cat_comment.user.nickname %>
        <% end %>
        <%= rescued_cat_comment.created_at.strftime('%Y/%m/%d') %>
        <%= rescued_cat_comment.comment %>
        <% if rescued_cat_comment.user == current_user %>
          <%= link_to "削除", rescued_cat_rescued_cat_comment_path(rescued_cat_comment.rescued_cat, rescued_cat_comment), method: :delete %>
        <% end %>
      </div>
      <% end %>

      <!-- コメントフォーム -->
     <div class="mt-3">
       <%= form_with model: [@rescued_cat, @rescued_cat_comment], class: "mb-3" do |f| %>
         <%= f.text_area :comment, rows: '5', placeholder: "コメントをここに", class: "form-control mb-2" %>
         <%= f.submit "送信する", class: "btn btn-primary text-right" %>
       <% end %>
     </div>

      <!-- 編集・削除ボタン -->
      <div class="container mt-5">
        <div class="row justify-content-center">
          <% if @rescued_cat.user == current_user %> 
            <%= link_to "編集する", edit_rescued_cat_path(@rescued_cat), class: "btn btn-success mr-3 " %>
            <%= link_to "削除", rescued_cat_path(@rescued_cat.id), method: :delete, class: "btn btn-danger", "data-confirm" => "本当に削除しますか？" %>
          <% end %>
        </div>
      </div>
    </div>
  </div>

</div>
